# Wonk Chatbot 网络部署指南

## 🌐 部署方案概览

### 免费方案（推荐新手）
1. **Railway** - 简单易用，自动部署
2. **Render** - 稳定可靠，GitHub集成
3. **Heroku** - 经典选择（有免费额度限制）

### 付费方案（推荐生产环境）
1. **VPS服务器** - 完全控制，性价比高
2. **云服务器** - 阿里云、腾讯云、AWS等
3. **容器服务** - Docker部署

## 🚀 方案1：Railway部署（最简单）

### 步骤1：准备代码
1. 将项目上传到GitHub
2. 确保项目根目录有 `requirements.txt`

### 步骤2：部署到Railway
1. 访问 [railway.app](https://railway.app)
2. 使用GitHub账号登录
3. 点击 "New Project" → "Deploy from GitHub repo"
4. 选择你的Wonk项目仓库
5. Railway会自动检测Python项目并部署

### 步骤3：配置环境变量
在Railway项目设置中添加：
```
FLASK_ENV=production
PORT=5000
```

### 步骤4：获取访问地址
部署完成后，Railway会提供一个类似这样的网址：
`https://your-project-name.up.railway.app`

## 🔧 方案2：Render部署

### 步骤1：准备GitHub仓库
确保项目包含以下文件：
- `requirements.txt`
- `deploy/render.yaml`（已创建）

### 步骤2：连接Render
1. 访问 [render.com](https://render.com)
2. 注册并连接GitHub账号
3. 点击 "New" → "Web Service"
4. 选择你的GitHub仓库

### 步骤3：配置部署
- **Build Command**: `pip install -r requirements.txt`
- **Start Command**: `python app.py`
- **Environment**: `Python 3`

### 步骤4：设置环境变量
```
FLASK_ENV=production
PYTHONUNBUFFERED=1
```

## 🐳 方案3：Docker部署（VPS服务器）

### 前提条件
- 一台VPS服务器（推荐配置：1GB RAM, 1 CPU）
- 已安装Docker和Docker Compose

### 步骤1：上传项目到服务器
```bash
# 使用git克隆或直接上传
git clone https://github.com/your-username/wonk-chatbot.git
cd wonk-chatbot
```

### 步骤2：构建和启动
```bash
# 进入部署目录
cd deploy

# 启动服务
docker-compose up -d
```

### 步骤3：配置域名（可选）
1. 购买域名并解析到服务器IP
2. 修改 `deploy/nginx.conf` 中的域名
3. 配置SSL证书（Let's Encrypt）

### 步骤4：SSL证书配置
```bash
# 安装certbot
sudo apt install certbot python3-certbot-nginx

# 获取SSL证书
sudo certbot --nginx -d your-domain.com

# 重启服务
docker-compose restart
```

## 🛠️ 方案4：传统VPS部署

### 步骤1：服务器环境准备
```bash
# 更新系统
sudo apt update && sudo apt upgrade -y

# 安装Python和必要工具
sudo apt install python3 python3-pip python3-venv nginx git -y
```

### 步骤2：部署应用
```bash
# 克隆项目
git clone https://github.com/your-username/wonk-chatbot.git
cd wonk-chatbot

# 创建虚拟环境
python3 -m venv venv
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt

# 创建systemd服务
sudo nano /etc/systemd/system/wonk-chatbot.service
```

### 步骤3：创建系统服务
```ini
[Unit]
Description=Wonk Chatbot
After=network.target

[Service]
User=www-data
WorkingDirectory=/path/to/wonk-chatbot
Environment=PATH=/path/to/wonk-chatbot/venv/bin
Environment=FLASK_ENV=production
ExecStart=/path/to/wonk-chatbot/venv/bin/python app.py
Restart=always

[Install]
WantedBy=multi-user.target
```

### 步骤4：启动服务
```bash
# 启用并启动服务
sudo systemctl enable wonk-chatbot
sudo systemctl start wonk-chatbot

# 检查状态
sudo systemctl status wonk-chatbot
```

## 🔒 安全配置

### 1. 修改密钥
在 `app.py` 中修改：
```python
app.secret_key = 'your-super-secret-key-here'
```

### 2. 环境变量配置
创建 `.env` 文件：
```
FLASK_SECRET_KEY=your-secret-key
FLASK_ENV=production
DATABASE_URL=sqlite:///data/database.db
```

### 3. 防火墙配置
```bash
# 只开放必要端口
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS
sudo ufw enable
```

## 📊 监控和维护

### 1. 日志查看
```bash
# Railway/Render: 在控制台查看日志
# VPS: 查看systemd日志
sudo journalctl -u wonk-chatbot -f
```

### 2. 数据库备份
```bash
# 定期备份数据库
cp data/database.db backups/database_$(date +%Y%m%d).db
```

### 3. 更新部署
```bash
# 拉取最新代码
git pull origin main

# 重启服务
sudo systemctl restart wonk-chatbot
```

## 🌟 推荐配置

### 新手推荐：Railway
- ✅ 最简单，几分钟完成部署
- ✅ 自动HTTPS
- ✅ 免费额度足够测试使用
- ❌ 免费版有使用限制

### 生产推荐：VPS + Docker
- ✅ 完全控制
- ✅ 成本可控
- ✅ 性能稳定
- ❌ 需要一定技术基础

## 🔗 访问你的聊天机器人

部署完成后，你将获得一个网址，例如：
- Railway: `https://wonk-chatbot-production.up.railway.app`
- Render: `https://wonk-chatbot.onrender.com`
- 自定义域名: `https://your-domain.com`

现在任何人都可以通过这个网址访问你的聊天机器人了！🎉
